@{
    var nombre = Common.Utilidades.Cortar(ViewData["DataUserName"].ToString());
}
<!DOCTYPE html>
<html lang="es-mx">
<!-- begin::Head -->
<head>
    <!--begin::Base Path (base relative path for assets of this page) -->
    <base href="./"><!--end::Base Path -->
    <meta charset="utf-8" />
    <title>@ViewData["Title"] | gila</title>
    <meta name="description" content="@ViewData["Descripcion"]">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!--begin::Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700">

    <!--end::Fonts -->
    <!--begin::Page Vendors Styles(used by this page) -->
    <link href="~/public/assets/plugins/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />

    <!--end::Page Vendors Styles -->
    <!--begin::Global Theme Styles(used by all pages) -->
    <link href="~/public/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/public/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
    @if (IsSectionDefined("Styles"))
    {@RenderSection("Styles", required: false)}
    <!--end::Global Theme Styles -->
    <!--begin::Layout Skins(used by all pages) -->
    <link href="~/public/assets/css/skins/header/base/light.css" rel="stylesheet" type="text/css" />
    <link href="~/public/assets/css/skins/header/menu/light.css" rel="stylesheet" type="text/css" />
    <link href="~/public/assets/css/skins/brand/navy.css" rel="stylesheet" type="text/css" />
    <link href="~/public/assets/css/skins/aside/navy.css" rel="stylesheet" type="text/css" />

    @*@Styles.Render("~/Content/css")
        @Scripts.Render("~/bundles/modernizr")*@
    <!--end::Layout Skins -->

    <link rel="shortcut icon" href="~/public/assets/media/logos/favicon.ico" />
</head>


<!-- end::Head -->
<!-- begin::Body -->
<body class="kt-quick-panel--right kt-demo-panel--right kt-offcanvas-panel--right kt-header--fixed kt-header-mobile--fixed kt-subheader--enabled kt-subheader--transparent kt-aside--enabled kt-aside--fixed kt-page--loading">

    <!-- begin:: Header Mobile -->
    <div id="kt_header_mobile" class="kt-header-mobile  kt-header-mobile--fixed ">
        <div class="kt-header-mobile__logo">
            <a href="@Url.Action("Index", "Home")">
                <img alt="Logo" src="~/public/assets/media/logos/logo2.png" />
            </a>
        </div>
        <div class="kt-header-mobile__toolbar">
            <button class="kt-header-mobile__toolbar-toggler kt-header-mobile__toolbar-toggler--left" id="kt_aside_mobile_toggler"><span></span></button>
            <button class="kt-header-mobile__toolbar-toggler" id="kt_header_mobile_toggler"><span></span></button>
            <button class="kt-header-mobile__toolbar-topbar-toggler" id="kt_header_mobile_topbar_toggler"><i class="flaticon-more"></i></button>
        </div>
    </div>

    <!-- end:: Header Mobile -->
    <!-- begin:: Root -->
    <div class="kt-grid kt-grid--hor kt-grid--root">

        <!-- begin:: Page -->
        <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--ver kt-page">

            <!-- begin:: Aside -->
            <button class="kt-aside-close " id="kt_aside_close_btn"><i class="la la-close"></i></button>
            <div class="kt-aside  kt-aside--fixed  kt-grid__item kt-grid kt-grid--desktop kt-grid--hor-desktop" id="kt_aside">

                <!-- begin::Aside Brand -->
                <div class="kt-aside__brand kt-grid__item " id="kt_aside_brand">
                    <div class="kt-aside__brand-logo">
                        <a href="@Url.Action("Index", "Home")">
                            <img alt="Logo" src="~/public/assets/media/logos/logo.png" />
                        </a>
                    </div>
                    <div class="kt-aside__brand-tools">
                        <button class="kt-aside__brand-aside-toggler kt-aside__brand-aside-toggler--left" id="kt_aside_toggler"><span></span></button>
                    </div>
                </div>

                <!-- end:: Aside Brand -->
                <!-- begin:: Aside Menu -->

                <div class="kt-aside-menu-wrapper kt-grid__item kt-grid__item--fluid" id="kt_aside_menu_wrapper">
                    <div id="kt_aside_menu" class="kt-aside-menu " data-ktmenu-vertical="1" data-ktmenu-scroll="1" data-ktmenu-dropdown-timeout="500">
                        <ul class="kt-menu__nav ">
                            @Html.Partial("_Navigation")
                        </ul>
                    </div>
                </div>

                <!-- end:: Aside Menu -->
                <!-- begin:: Aside Footer -->
                <div class="kt-aside__footer kt-grid__item" id="kt_aside_footer">
                    <div class="kt-aside__footer-nav">

                        <div class="kt-aside__footer-item">
                            <h6 id="reloj">@DateTime.Now.ToShortDateString()</h6>&ensp;
                            <i class="flaticon2-calendar-2"></i>
                        </div>
                    </div>
                </div>

                <!-- end:: Aside Footer-->
            </div>

            <!-- end:: Aside -->
            <!-- begin:: Wrapper -->
            <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor kt-wrapper" id="kt_wrapper">

                <!-- begin:: Header -->
                <div id="kt_header" class="kt-header kt-grid__item  kt-header--fixed ">

                    <!-- begin:: Header Menu -->
                    <button class="kt-header-menu-wrapper-close" id="kt_header_menu_mobile_close_btn"><i class="la la-close"></i></button>
                    <div class="kt-header-menu-wrapper" id="kt_header_menu_wrapper">
                        <div id="kt_header_menu" class="kt-header-menu kt-header-menu-mobile  kt-header-menu--layout- ">
                            @*Menu a la izquierda*@
                        </div>
                    </div>

                    <!-- end:: Header Menu -->
                    <!-- begin:: Header Topbar -->
                    <div class="kt-header__topbar">

                        <!--begin:: Languages -->
                        <div class="kt-header__topbar-item kt-header__topbar-item--langs">
                            <div class="kt-header__topbar-wrapper" data-toggle="dropdown" data-offset="10px,0px">
                                <span class="kt-header__topbar-icon">
                                    <img class="" src="~/public/assets/media/flags/252-mexico.svg" alt="" />
                                </span>
                            </div>
                            <div class="dropdown-menu dropdown-menu-fit dropdown-menu-right dropdown-menu-anim dropdown-menu-top-unround">
                                <ul class="kt-nav kt-margin-t-10 kt-margin-b-10">
                                    <li class="kt-nav__item kt-nav__item--active">
                                        <a href="#" class="kt-nav__link">
                                            <span class="kt-nav__link-icon"><img src="~/public/assets/media/flags/252-mexico.svg" alt="" /></span>
                                            <span class="kt-nav__link-text">Español</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!--end:: Languages -->
                        <!--begin: User Bar -->
                        <div class="kt-header__topbar-item kt-header__topbar-item--user">
                            <div class="kt-header__topbar-wrapper" data-toggle="dropdown" data-offset="0px,0px">

                                <!--use "kt-rounded" class for rounded avatar style-->
                                <div class="kt-header__topbar-user kt-rounded-">
                                    <span class="kt-header__topbar-welcome kt-hidden-mobile">Hola,</span>
                                    <span class="kt-header__topbar-username kt-hidden-mobile">@nombre</span>
                                    <img alt="Pic" src="~/public/assets/media/users/default.jpg" class="kt-rounded-" />

                                    <!--use below badge element instead the user avatar to display username's first letter(remove kt-hidden class to display it) -->
                                    <span class="kt-badge kt-badge--username kt-badge--lg kt-badge--brand kt-hidden kt-badge--bold">S</span>
                                </div>
                            </div>
                            <div class="dropdown-menu dropdown-menu-fit dropdown-menu-right dropdown-menu-anim dropdown-menu-top-unround dropdown-menu-sm">
                                <div class="kt-user-card kt-margin-b-40 kt-margin-b-30-tablet-and-mobile" style="background-image: url(@Url.Content("~/public/assets/media/misc/head_bg_sm.jpg"))">
                                    <div class="kt-user-card__wrapper">
                                        <div class="kt-user-card__pic">

                                            <!--use "kt-rounded" class for rounded avatar style Html.IsUrl() -->
                                            <img alt="Pic" src="~/public/assets/media/users/default.jpg" class="kt-rounded-" />
                                        </div>
                                        <div class="kt-user-card__details">
                                            <div class="kt-user-card__name">@ViewData["DataUserName"].ToString()</div>
                                            <div class="kt-user-card__position">Gila Software.</div>
                                        </div>
                                    </div>
                                </div>
                                <ul class="kt-nav kt-margin-b-10">
                                    @*<li class="kt-nav__item">
                                <a href="custom/profile/personal-information.html" class="kt-nav__link">
                                    <span class="kt-nav__link-icon"><i class="flaticon2-calendar-3"></i></span>
                                    <span class="kt-nav__link-text">My Profile</span>
                                </a>
                            </li>
                            <li class="kt-nav__item">
                                <a href="custom/profile/overview-1.html" class="kt-nav__link">
                                    <span class="kt-nav__link-icon"><i class="flaticon2-browser-2"></i></span>
                                    <span class="kt-nav__link-text">My Tasks</span>
                                </a>
                            </li>
                            <li class="kt-nav__item">
                                <a href="custom/profile/overview-2.html" class="kt-nav__link">
                                    <span class="kt-nav__link-icon"><i class="flaticon2-mail"></i></span>
                                    <span class="kt-nav__link-text">Messages</span>
                                </a>
                            </li>
                            <li class="kt-nav__item">
                                <a href="custom/profile/account-settings.html" class="kt-nav__link">
                                    <span class="kt-nav__link-icon"><i class="flaticon2-gear"></i></span>
                                    <span class="kt-nav__link-text">Settings</span>
                                </a>
                            </li>*@
                                    <li class="kt-nav__separator kt-nav__separator--fit"></li>
                                    <li class="kt-nav__custom kt-space-between">
                                        <a href="@Url.Action("Logout", "Login")" class="btn btn-label-brand btn-upper btn-sm btn-bold"><i class="flaticon-logout"></i>Cerrar Sesión</a>
                                        <i class="flaticon2-edit kt-label-font-color-2" data-toggle="modal" data-placement="right" data-target="#modalPass" aria-haspopup="true" aria-expanded="false" title="" data-original-title="Cambiar contraseña"></i>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!--end: User Bar -->

                    </div>

                    <!-- end:: Header Topbar -->
                </div>

                <!-- end:: Header -->
                    <div class="kt-content  kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor" id="kt_content">
                        @RenderBody()
                    </div>

                    <!-- begin:: Footer -->
                    <div class="kt-footer kt-grid__item kt-grid kt-grid--desktop kt-grid--ver-desktop">
                        <div class="kt-container  kt-container--fluid ">
                            <div class="kt-footer__copyright">
                                2021&nbsp;&copy;&nbsp;<a href="#" target="_blank" class="kt-link">HSoft Inc.</a>
                            </div>
                            <div class="kt-footer__menu">
                                <a href="#" target="_blank" class="kt-footer__menu-link kt-link">Acerca</a>
                                <a href="#" target="_blank" class="kt-footer__menu-link kt-link">Contacto</a>
                            </div>
                        </div>
                    </div>

                    <!-- end:: Footer -->
                </div>

                <!-- end:: Wrapper -->
            </div>

        <!-- end:: Page -->
    </div>

    <!-- end:: Root -->
    <!-- begin:: Scrolltop -->
    <div id="kt_scrolltop" class="kt-scrolltop">
        <i class="la la-arrow-up"></i>
    </div>

    <!-- end:: Scrolltop -->
    <!--begin::Modal-->

    <div class="modal fade" id="modalPass" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="modalPass" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalReset">Cambiar Contraseña</h5>
                    @*<button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true" class="la la-remove"></span>
                    </button>*@
                </div>
                <form class="kt-form kt-form--fit kt-form--label-align-right" id="formReset">
                    <div class="modal-body">
                        <div class="form-group row m--margin-top-10">
                            <label class="col-xl-3 col-lg-3 col-form-label">Contraseña actual</label>
                            <div class="col-lg-9 col-xl-6">
                                <input type="password" id="clave" name="clave" class="form-control" value="" placeholder="Contraseña actual">
                            </div>
                        </div>

                        <div class="form-group row m--margin-top-10">
                            <label class="col-xl-3 col-lg-3 col-form-label">Nueva contraseña</label>
                            <div class="col-lg-9 col-xl-6">
                                <input type="password" id="newclave" name="newclave" class="form-control" value="" placeholder="Nueva contraseña">
                            </div>
                        </div>
                        <div class="form-group row m--margin-top-10">
                            <label class="col-xl-3 col-lg-3 col-form-label">Verificar contraseña</label>
                            <div class="col-lg-9 col-xl-6">
                                <input type="password" id="verifyclave" name="verifyclave" class="form-control" value="" placeholder="Verificar contraseña">
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button id="btnModalCancel" type="button" class="btn btn-secondary" data-dismiss="modal">
                            <i class="la la-close"></i>
                            <span class="kt-hidden-mobile">Cancelar</span>
                        </button>
                        <button type="submit" id="btnResetPass" class="btn btn-primary kt-btn">
                            <i class="la la-check"></i>
                            <span class="kt-hidden-mobile">Guardar</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!--end::Modal-->
    <!-- begin::Global Config(global config for global JS sciprts) -->
    <script>
        var KTAppOptions = {
            "colors": {
                "state": {
                    "brand": "#5d78ff",
                    "metal": "#c4c5d6",
                    "light": "#ffffff",
                    "accent": "#00c5dc",
                    "primary": "#5867dd",
                    "success": "#34bfa3",
                    "info": "#36a3f7",
                    "warning": "#ffb822",
                    "danger": "#fd3995",
                    "focus": "#9816f4"
                },
                "base": {
                    "label": [
                        "#c5cbe3",
                        "#a1a8c3",
                        "#3d4465",
                        "#3e4466"
                    ],
                    "shape": [
                        "#f0f3ff",
                        "#d9dffa",
                        "#afb4d4",
                        "#646c9a"
                    ]
                }
            }
        };
    </script>

    <!-- end::Global Config -->
    <!--begin::Global Theme Bundle(used by all pages) -->
    <script src="~/public/assets/plugins/global/plugins.bundle.js" type="text/javascript"></script>
    <script src="~/public/assets/js/scripts.bundle.js" type="text/javascript"></script>

    <!--end::Global Theme Bundle -->
    <!--begin::Page Vendors(used by this page) -->
    <script src="~/Scripts/Sistema/jquery.numeric.js" type="text/javascript"></script>

    <!--end::Page Vendors -->
    <!--begin::Page Scripts(used by this page)-->
    @*<script src="~/public/assets/js/pages/dashboard.js" type="text/javascript"></script>*@

    <script>
        var KTFormControlsReset = function () {
            // Private functions

            var demo = function () {
                $("#formReset").validate({
                    // define validation rules
                    rules: {
                        clave: {
                            required: true,
                            minlength: 9,
                        },
                        newclave: {
                            required: true,
                            minlength: 9,
                        },
                        verifyclave: {
                            equalTo: "#newclave"
                        }
                    },

                    //display error alert on form submit
                    invalidHandler: function (event, validator) {
                        swal.fire({
                            "title": "",
                            "text": "Hay algunos errores en su envío. Por favor corríjalos.",
                            "type": "error",
                            "confirmButtonClass": "btn btn-secondary kt-btn kt-btn--wide",
                            "onClose": function (e) {
                            }
                        });

                        event.preventDefault();
                    },

                    submitHandler: function (form) {
                        //form[0].submit(); // submit the form
                        KTApp.block('#modalPass', {
                            overlayColor: '#000000',
                            type: 'v2',
                            state: 'primary',
                            message: 'Procesando...'
                        });
                        
                        var objOrden = {
                            'Clave': $("#clave").val(),
                            'NewClave': $("#newclave").val()
                        };

                        $.ajax({
                            type: 'POST',
                            url: '@Url.Action("Resert", "Usuario")',
                            dataType: "json",
                            data: JSON.stringify(objOrden),
                            contentType: "application/json; charset=utf-8",
                            success: function (resp) {
                                if (resp.mensaje == 1) {
                                    Swal.fire({
                                        title: 'GUARDADO',
                                        text: "GUARDADO EXITOSO.!!!",
                                        type: 'success',
                                        showCancelButton: false,
                                    }).then((result) => {

                                        $.ajax({
                                            url: "@Url.Action("Logout", "Login")",
                                            success: function (data) {
                                                location.reload();
                                                }
                                            });

                                    });
                                }
                                else {
                                    swal.fire("ERROR AL GUARDAR", "DETALLE: " + resp.errorMensaje + ".", "warning");
                                }
                            },
                            error: function (xhr, desc, err) {
                                swal.fire("VALIDAZACIÓN", "DETALLE: " + desc + "\nError: " + err + "\n" + xhr.responseText + ".", "error");
                            }
                        });

                        setTimeout(function () {
                            KTApp.unblock('#modalPass');
                        }, 500);

                        return false;
                    }
                });
            }

            return {
                // public functions
                init: function () {
                    demo();
                }
            };
        }();

        var KTBootstrapTooltipsDemo = function () {
            //Private functions

            // Demo 1
            var demo1 = function () {
                $('[data-toggle="tooltip"]').tooltip();
            }

            return {
                // Public functions
                init: function () {
                    demo1();
                }
            };
        }();


        const formatter = new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: 'USD',
            minimumFractionDigits: 2
        });

        $(document).ready(function () {
            actualizarHora();
            KTFormControlsReset.init();

            KTBootstrapTooltipsDemo.init();
            
            $('.kt_selectpicker').selectpicker();

            checkCambio();
            //setInterval(actualizarHora, 1000);

            $('#modalPass').on('show.bs.modal', function (event) {
                $('#clave').val('');
                $('#newclave').val('');
                $('#verifyclave').val('');
                $('#btnModalCancel').removeClass('kt-hidden');
            });

        });

        var actualizarHora = function () {
            $.ajax({
                type: "POST",
                url: '@Url.Action("do", "Home")',
                dataType: "json",
                success: function (result) {
                    var pReloj = document.getElementById('reloj');
                    var strDate = result;
                    pReloj.textContent = strDate;
                },
                error: function () {
                    console.error('Error en reloj');
                }
            });
        };

        var checkCambio = function () {
            $.ajax({
                type: "POST",
                url: '@Url.Action("CheckChange", "Home")',
                dataType: "json",
                success: function (result) {
                    if (result.mensaje == 1) {
                        $('#modalPass').modal('show');
                        $('#btnModalCancel').addClass('kt-hidden');
                        $('#btnModalCancel').prop('disabled', true);
                    }
                },
                error: function () {
                    console.error('Error en checkCambio');
                }
            });
        };

        function goBack() {
            window.history.go(-1);
        }

    </script>

    <!-- Handler for local scripts -->
    @RenderSection("Scripts", required: false)
</body>
<!-- end::Body -->
</html>